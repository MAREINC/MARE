<script id="tools-inquiry-report-template" type="text/x-handlebars-template">
	<button type="button" class="sidebarCollapse sidebarCollapse--content btn btn-info mb-4">
		Reports
	</button>
	
    <h2 class="panel__h2 mb-2">Inquiry Report</h2>
    <div class="inquiry-report">

        <div class="filter-form mb-2">
            <div class="row">
                <div class="col-lg-2 align-middle">
                    <div class="filter-form__label mh-100">
                    <p>Date range:</p>
                    </div>
                </div>
                <div class="col-6 col-lg-5">
                    <div class="form-group">
                        <div class="input-daterange">
                            <label for="fromDate"><span class="sr-only">To Date</span>
                                <input  class="form-control" type="date" name="fromDate" id="fromDate" value="{{ fromDate }}" required />
                                <div class="input-group-addon">
                                    <span></span>
                                </div>
                            </label>								
                        </div>
                    </div>
                </div>
                <div class="col-6 col-lg-5">
                    <div class="form-group">
                        <div class="input-daterange">
                            <label for="toDate"><span class="sr-only">To Date</span>
                                <input class="form-control" type="date" name="toDate" id="toDate" value="\{{ toDate }}" required />
                                <div class="input-group-addon">
                                    <span></span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <form class="matching-form">
            <input type="hidden" id="defaultFromDate" value="{{ defaultInquiryDateRange.fromDate }}" />
            <input type="hidden" id="defaultToDate" value="{{ defaultInquiryDateRange.toDate }}" />
            <div class="row">
                <div class="col-6">
                    <div class="row form-group">
                        <div class="col-sm-12 col-md-4 text-sm-right" >
                            <label for="source" class="bold">Source:</label>
                        </div>
                        <div class="col-sm-12 col-md-8">
                            <select id="source" name="source[]" class="form-control source-select" multiple>
                                \{{#each sources as |source|}}
                                    <option value="\{{ source.id }}" selected>\{{ source.text }}</option>
                                \{{/each}}
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="row form-group">
                        <div class="col-sm-12 col-md-4 text-sm-right" >
                            <label for="inquirer" class="bold">Inquirer:</label>
                        </div>
                        <div class="col-sm-12 col-md-8">
                            <select id="inquirer" name="inquirer[]" class="form-control inquirer-select" multiple>
                                {{#each inquirers as |inquirer|}}
                                    <option value="{{ inquirer }}">{{ inquirer }}</option>
                                {{/each}}
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="row form-group">
                        <div class="col-sm-12 col-md-4 text-sm-right" >
                            <label for="inquiryType" class="bold">Inquiry Type:</label>
                        </div>
                        <div class="col-sm-12 col-md-8">
                            <select id="inquiryType" name="inquiryType[]" class="form-control inquiry-type-select" multiple>
                                {{#each inquiryTypes as |inquiryType|}}
                                    <option value="{{ inquiryType }}">{{ inquiryType }}</option>
                                {{/each}}
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="row form-group">
                        <div class="col-sm-12 col-md-4 text-sm-right" >
                            <label for="inquiryMethod" class="bold">Inquiry Method:</label>
                        </div>
                        <div class="col-sm-12 col-md-8">
                            <select id="inquiryMethod" name="inquiryMethod[]" class="form-control inquiry-method-select" multiple>
                                {{#each inquiryMethods as |inquiryMethod|}}
                                    <option value="{{ inquiryMethod._id }}">{{ inquiryMethod.inquiryMethod }}</option>
                                {{/each}}
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <button class="btn btn-primary inquiries-search-button">Search</button>
	    <button class="btn btn-default inquiries-search-reset-button">Reset</button>

        \{{#if waitingForResults }}
            <br /><br />
            Loading the data ...
        \{{/if}}
        
        \{{#if noResultsFound }}
            <br /><br />
            No results found
        \{{/if}}

        \{{#if results }}
            <h3>Results: </h3>
            <div class="matching-results-table__button-bar">
                <button class="button button--teal inquiry-export-pdf-button">PDF Export</button>
                <button class="button button--teal inquiry-export-xlsx-button">XLSX Export</button>
                <div class="matching-results-table__record-count">
                    <div class="record-count__label">Total Inquiries:</div>
                    \{{ results.length }}
                </div>
            </div>
                    
            <table width="100%" class="matching-results-table">
                <tr>
                    <th class="column--numerical">Reg #</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Child SW Region</th>
                    <th>Inquiry Type</th>
                    <th>Inquiry Method</th>
                    <th class="column--numerical">Reg #</th>
                    <th>Contact 1</th>
                    <th>Contact 2</th>
                </tr>
                \{{#each results as |result|}}
                    <tr>
                        <td class="column--numerical">
                            \{{#if result.childId}}
                                <a href="/keystone/children/\{{ result.childId }}">\{{ result.childRegistrationNumber }}</a>
                            \{{else}}
                                --
                            \{{/if}}
                        </td>
                        <td>\{{ result.childNameFirst }}</td>
                        <td>\{{ result.childNameLast }}</td>
                        <td>\{{ result.childsSWAgencyRegion }}</td>
                        <td>\{{ result.inquiryType }}</td>
                        <td>\{{ result.inquiryMethod }}</td>
                        <td class="column--numerical">
                            \{{#if result.familyId}}
                                <a href="/keystone/families/\{{ result.familyId }}">\{{ result.familyRegistrationNumber }}</a>
                            \{{else}}
                                --
                            \{{/if}}
                        </td>
                        <td>\{{ result.familyContact1 }}</td>
                        <td>\{{ result.familyContact2 }}</td>
                    </tr>
                    \{{#if result.siblings}}
                        <tr>
                            <td></td>
                            <td colspan="100">
                                <i>\{{ result.childNameFirst }} has the following siblings:</i>
                                <table width="100%">
                                    <tr>
                                        <th>Reg #</th>
                                        <th>Name</th>
                                    </tr>
                                    \{{#each result.siblings as |sibling|}}
                                        <tr>
                                            <td width="75px">
                                                <a href="/keystone/children/\{{ sibling.siblingId }}">\{{ sibling.siblingRegistrationNumber }}</a>
                                            </td>
                                            <td>\{{ sibling.siblingName }}</td>
                                        </tr>
                                    \{{/each}}
                                </table>
                            </td>
                        </tr>
                    \{{/if}}
                \{{else}}
                    <tr>
                        <td colspan="100">No results found</td>
                    </tr>
                \{{/each}}
            </table>
        \{{/if}}
    </div>
</script>